<?xml version="1.0" encoding="utf-8"?>
<DataTypeDefinition>
  <url value="http://hl7.org/v2plus/DataTypeDefinition/repeat-pattern"/>
  <name value="repeat pattern"/>
  <withdrawn value="false"/>
  <abbreviation value="RPT"/>
  <description>
    <status value="additional"/>
    <div>
      <p>Definition: The repeat pattern data type should be used where it is necessary to define the frequency at which an event is to take place. This data type provides a way to define repeat pattern codes "on the fly". The repeat pattern code is equivalent to the TQ data type, component 2, sub-component 1 (repeat pattern). The additional components define the meaning of the repeat pattern code. Components 2 - 10 are used to define relatively simple repeat patterns. Component 11 is provided to define complex repeat patterns. This data type forms a bridge between the 2.x Repeat Pattern concept from Quantity/Timing, and the Version 3.0 GTS General Timing Specification. Component 1 is the 2.x concept of repeat pattern. Components 2-7 are derived from the version 3.0 data type PIVL. Components 8-10 are derived from the version 3.0 EIVL data type. If a repeat pattern cannot be defined using components 2-10, then component 11, General Timing Specification is provided. This allows the full literal form of the version 3.0 GTS to be specified.</p>
      <p>When using the RPT, if an application doesn't recognize the code in component 1, then it may attempt to determine the appropriate frequency using the remaining components. If the application does recognize the code in component 1, the application is not required to determine the frequency from the remaining components.</p>
      <p><strong>Use Case</strong>: The use case supporting this proposal is the need to define repeat patterns on the fly while placing an order. The TQ data type did not have the capability to define the meaning of a repeat pattern on the fly. To get around this problem, vendors have implemented a variety of solutions to solve this issue. One way was to add Z-components to the TQ data type to transmit information about the repeat pattern. Another solution was to attempt to parse the repeat pattern code in an attempt to decipher what the code meant.</p>
      <p>Examples:</p>
      <p>|Q1H&amp;Every 1 Hour&amp;HL7xxx^^^^1^h|</p>
      <p>|Q2J2&amp;Every second Tuesday&amp;HL7xxx^DW^2^^2^wk|</p>
      <p>|BID&amp;Twice a day at institution specified times&amp;HL7xxx^^^^12^h^Y|</p>
      <p>|QAM&amp;Every morning at the institution specified time&amp;HL7xxx^HD^00^11^1^d^Y|</p>
      <p>|QHS&amp;Every day before the hours of sleep&amp;HL7xxx^^^^1^d^^AHS|</p>
      <p>|ACM&amp;Before Breakfast&amp;HL7xxx^^^^^^^ACM|</p>
    </div>
  </description>
  <component>
    <name value="Repeat Pattern Code"/>
    <sequenceNumber value="1"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: A code representing the repeat pattern defined by the other components of this data type. Refer to <a href="file:///C:\AppData\Local\Microsoft\Windows\AppData\Local\Microsoft\Windows\Temporary%20Internet%20Files\Starting_Point_Word\V28_CH02C_CodeTables.doc#HL70335"><em>User-defined Table 0335 – Repeat Pattern</em></a> for suggested values.</p>
      </div>
    </definition>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/coded-with-exceptions"/>
    <binding value="www.hl7.org/fhir/v2/0335/index.html"/>
  </component>
  <component>
    <name value="Calendar Alignment"/>
    <sequenceNumber value="2"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: Specifies an alignment of the repetition to a calendar (e.g., to distinguish every 30 days from “the 5<sup>th</sup> of every month”). Refer to <a href="file:///C:\AppData\Local\Microsoft\Windows\AppData\Local\Microsoft\Windows\Temporary%20Internet%20Files\Starting_Point_Word\V28_CH02C_CodeTables.doc#HL70527"><em>HL7 Table 0527 - Calendar Alignment</em></a> for valid values.</p>
      </div>
    </definition>
    <minLength value="2"/>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/coded-value-for-hl7-defined-tables"/>
    <binding value="www.hl7.org/fhir/v2/0527/index.html"/>
  </component>
  <component>
    <name value="Phase Range Begin Value"/>
    <sequenceNumber value="3"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: Used for Calendar aligned repeat patterns to determine the amount of time from the beginning of particular <em>RPT.2 - Calendar Alignment</em> to the beginning of the phase. If Calendar Alignment is DW (days of week), then this would be the offset from the beginning of the week.</p>
        <p>If Phase Range Begin Value is populated, but Phase Range End Value is not populated, then this component defines when the period (RPT.5, 6) begins.</p>
        <p>If both Phase Range Begin Value and Phase Range End Value are populated, then this component defines the earliest point in time at which the period (RPT.5, 6) will begin.</p>
        <p>The units of measure for this component are derived from the Calendar Alignment value in RPT.2. See <em><a href="file:///C:\AppData\Local\Microsoft\Windows\AppData\Local\Microsoft\Windows\Temporary%20Internet%20Files\Starting_Point_Word\V28_CH02C_CodeTables.doc#HL70527">HL7 Table 0527 - Calendar Alignment</a></em> for the units of measure associated with a particular calendar alignment.</p>
      </div>
    </definition>
    <confLength value="10"/>
    <mayTruncate value="false"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/numeric"/>
  </component>
  <component>
    <name value="Phase Range End Value"/>
    <sequenceNumber value="4"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: Used for Calendar aligned repeat patterns to determine the amount of time from the beginning of particular <em>RPT.2 - Calendar Alignment</em> to the end of the phase.</p>
        <p>If Phase Range End Value is populated, but Phase Range Begin Value is not populated, then this component defines when the timing period (RPT.5, 6) begins.</p>
        <p>If both Phase Range Begin Value and Phase Range End Value are populated, then this component defines the latest point in time at which the period (RPT.5, 6) will begin.</p>
        <p>The units of measure for this component are derived from the Calendar Alignment value in RPT.2. See <em><a href="file:///C:\AppData\Local\Microsoft\Windows\AppData\Local\Microsoft\Windows\Temporary%20Internet%20Files\Starting_Point_Word\V28_CH02C_CodeTables.doc#HL70527">HL7 Table 0527 - Calendar Alignment</a></em> for the units of measure associated with a particular calendar alignment.</p>
      </div>
    </definition>
    <confLength value="10"/>
    <mayTruncate value="false"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/numeric"/>
  </component>
  <component>
    <name value="Period Quantity"/>
    <sequenceNumber value="5"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: A time duration specifying the frequency at which the periodic interval repeats. <em>RPT.6 - Period Units</em> defines the units of time for this component.</p>
      </div>
    </definition>
    <confLength value="10"/>
    <mayTruncate value="false"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/numeric"/>
  </component>
  <component>
    <name value="Period Units"/>
    <sequenceNumber value="6"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: Defines the units used for <em>RPT.5 - Period Quantity</em>. Constrained to units of time. Best practice is to use UCUM. Refer to External table the Unified Code for Units of Measure (UCUM) [<a href="http://aurora.rg.iupui.edu/UCUM" class="uri">http://aurora.rg.iupui.edu/UCUM</a>] for valid values.</p>
        <p>Condition Rule: This component is required if <em>RPT.5 - Period Quantity</em> is populated.</p>
      </div>
    </definition>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/coded-with-exceptions"/>
  </component>
  <component>
    <name value="Institution Specified Time"/>
    <sequenceNumber value="7"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: A code that indicates whether the exact timing is up to the party executing the schedule (e.g., to distinguish “every 8 hours” from “3 times a day”). Refer to <a href="file:///C:\AppData\Local\Microsoft\Windows\AppData\Local\Microsoft\Windows\Temporary%20Internet%20Files\Starting_Point_Word\V28_CH02C_CodeTables.doc#HL70136"><em>HL7 Table 0136 - Yes/No Indicator</em></a> for valid values.</p>
        <ul>
          <li>
            <p>Y - exact timing up to party executing schedule.</p>
          </li>
          <li>
            <p>N - exact timing as specified.</p>
          </li>
        </ul>
      </div>
    </definition>
    <minLength value="1"/>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/coded-value-for-hl7-defined-tables"/>
    <binding value="www.hl7.org/fhir/v2/0136/index.html"/>
  </component>
  <component>
    <name value="Event"/>
    <sequenceNumber value="8"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: A code for a common (periodical) activity of daily living. Refer to <a href="file:///C:\AppData\Local\Microsoft\Windows\AppData\Local\Microsoft\Windows\Temporary%20Internet%20Files\Starting_Point_Word\V28_CH02C_CodeTables.doc#HL70528"><em>HL7 Table 0528 - Event-Related Period</em></a> for valid values.</p>
      </div>
    </definition>
    <minLength value="2"/>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/coded-value-for-hl7-defined-tables"/>
    <binding value="www.hl7.org/fhir/v2/0528/index.html"/>
  </component>
  <component>
    <name value="Event Offset Quantity"/>
    <sequenceNumber value="9"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: An interval that marks the offsets for the beginning, width and end of the event-related periodic interval measured from the time each such event actually occurred. A positive numeric value indicates the amount of time after the event in RPT.8. A negative numeric value indicates the amount of time prior to the event in <em>RPT.8</em>. <em>RPT.10 - Event Offset Units</em> defines the units of time for this component.</p>
        <p><strong>Usage Note:</strong> This component should not be valued unless there is a value in RPT-8 (Event).</p>
      </div>
    </definition>
    <confLength value="10"/>
    <mayTruncate value="false"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/numeric"/>
  </component>
  <component>
    <name value="Event Offset Units"/>
    <sequenceNumber value="10"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: Defines the units used for RPT-9 (Event Offset Quantity). Constrained to units of time. The codes for unit of measure are specified in the Unified Code for Units of Measure (UCUM) [<a href="http://aurora.rg.iupui.edu/UCUM" class="uri">http://aurora.rg.iupui.edu/UCUM</a>].</p>
        <p>Condition Rule: This component is required if <em>RPT.9 - Event Offset Quantity</em> is populated.</p>
      </div>
    </definition>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/coded-with-exceptions"/>
  </component>
  <component>
    <name value="General Timing Specification"/>
    <sequenceNumber value="11"/>
    <definition>
      <status value="additional"/>
      <div>
        <p>Definition: The General Timing Specification as defined by the Version 3 Data Types document.</p>
      </div>
    </definition>
    <mayTruncate value="not applicable"/>
    <dataType value="https://www.hl7.org/v2plus/DataTypeDefinition/general-timing-specification"/>
  </component>
</DataTypeDefinition>
